# Vim学習サイト仕様書

**プロジェクト名**: にゃぱんと学ぶVim冒険記
**作成日**: 2025-12-20
**バージョン**: 2.0（挫折防止特化版）

---

## 目次

1. [コンセプト](#1-コンセプト)
2. [挫折防止の設計思想](#2-挫折防止の設計思想)
3. [キャラクター「にゃぱん」](#3-キャラクターにゃぱん)
4. [カリキュラム構成（第0章〜第6章）](#4-カリキュラム構成第0章第6章)
5. [各章の詳細設計](#5-各章の詳細設計)
6. [挫折防止システム機能](#6-挫折防止システム機能)
7. [UI/UX設計](#7-uiux設計)
8. [リアルタイムキーボード表示](#8-リアルタイムキーボード表示)
9. [覚えたコマンド一覧](#9-覚えたコマンド一覧)
10. [復習モード](#10-復習モード)
11. [進捗管理・実績システム](#11-進捗管理実績システム)
12. [SNSシェア機能](#12-snsシェア機能)
13. [技術仕様](#13-技術仕様)
14. [ページ構成](#14-ページ構成)
15. [将来の拡張機能](#15-将来の拡張機能)
16. [付録：コマンド一覧](#16-付録コマンド一覧)

---

## 1. コンセプト

### ビジョン
**「Vim挫折者をゼロにする」** — 可愛いキャラクター「にゃぱん」と一緒に、ブラウザ上の安全な環境でVimを楽しく学ぶ。

### コンセプトの転換

| 従来のVim学習 | 本サイトのアプローチ |
|--------------|---------------------|
| コマンドの羅列暗記 | **Vim語**として文法を習得 |
| 黒い画面への恐怖 | パステル調UI + キャラサポート |
| 孤独な学習 | にゃぱんが常に寄り添う |
| 失敗＝挫折 | 失敗を安全に体験できるサンドボックス |
| Vim完全移行がゴール | **VSCode+Vim拡張も正解**と肯定 |

### ターゲットユーザー
- Vimを初めて学ぶプログラミング初心者
- 過去にVimで挫折した経験がある人
- 楽しく学びたいエンジニア
- 可愛いキャラクターと一緒に学びたい人

### 学習の3ステップ（各章共通）

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   📖 学ぶ (Learn)     →    🎯 練習 (Practice)    →    ⚔️ 実践 (Act)
│   ストーリー形式で        ドリル・ミニゲームで       リアルな課題で
│   概念を理解              反復練習                   スキルを定着
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 2. 挫折防止の設計思想

### Vim学習の「3つの壁」と対策

| 壁 | 離脱タイミング | 原因 | 本サイトの対策 |
|----|---------------|------|---------------|
| **生存の壁** | 最初の5分〜1週間 | 終了できない、モードがわからない | 第0章で徹底的にカバー |
| **文法の壁** | 2〜4週間 | コマンド暗記の限界 | 「動詞+名詞」の言語習得アプローチ |
| **環境の壁** | 1〜3ヶ月 | 設定地獄、生産性の谷 | VSCode+Vim拡張も正解と提示 |

### 言語学習のアナロジー

```
Vimの学習 ≒ 英会話の学習

┌──────────────────────────────────────────────────────────┐
│                                                          │
│  🆘 生存 (Survival)                                      │
│  └─ 遭難しないために「終わらせ方」と「歩き方」を覚える   │
│                                                          │
│  📝 文法 (Grammar)                                       │
│  └─ フレーズ丸暗記ではなく「動詞＋名詞」の文法を理解     │
│                                                          │
│  💬 流暢さ (Fluency)                                     │
│  └─ 「テキストオブジェクト」という熟語で思考速度で編集   │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

### コンテンツ制作の3原則

1. **「なぜ？」の先出し**
   - いきなり「hで左」ではなく、動機づけから入る
   - 例：「矢印キーまで手を動かすと0.5秒のロス。1日1000回で何分の損？」

2. **失敗のシミュレーション**
   - 安全なサンドボックスでエラーを体験させる
   - 本番でのパニックを事前に防ぐ

3. **ロードマップの可視化**
   - 「今は生産性の谷にいます。あと2章でVSCodeより速くなります」
   - 学習の終わりが見えない不安を解消

---

## 3. キャラクター「にゃぱん」

### 基本設定

| 項目 | 内容 |
|------|------|
| 名前 | にゃぱん |
| 種族 | 猫耳の女の子（異世界からの案内人） |
| 性格 | 優しい・励まし上手・ちょっとドジ |
| 役割 | Vimの状態を「代弁」するパートナー |
| 特徴 | 茶色の髪、猫耳、赤いリボン、ロングコート |

### にゃぱんの最重要機能：モード状態の視覚化

初心者の混乱の主因は「今どのモードにいるかわからない」こと。
にゃぱんが**Vimの状態を視覚的に代弁**することで、認知負荷を劇的に下げる。

| Vimの状態 | にゃぱんの表示 | ポーズ・表情 |
|-----------|---------------|-------------|
| ノーマルモード | 待機中 | 仁王立ち（命令待ち） |
| インサートモード | 執筆中 | ペンを持つポーズ |
| コマンドラインモード | 呪文詠唱中 | 杖を構えるポーズ |
| ビジュアルモード | 選択中 | 範囲を指すポーズ |
| **IME（日本語）ON** | **警告** | 「言葉が通じないよ！」 |
| エラー発生 | 困惑 | 転ぶ or 「？」マーク |
| 成功時 | 喜び | 笑顔 + 拍手 |

### にゃぱんの登場パターン

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   ┌─────────────┐                                      │
│   │             │   💬 吹き出し                        │
│   │  にゃぱん   │   ┌─────────────────────────────┐   │
│   │  [状態に    │   │「Escを押して！               │   │
│   │   応じた    │   │ 日本語入力になってるよ！」   │   │
│   │   ポーズ]   │   └─────────────────────────────┘   │
│   │             │                                      │
│   └─────────────┘                                      │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### セリフ例

#### レッスン開始時
- 「今日は一緒に○○を覚えよう！」
- 「この章をクリアすれば、もっとVimが好きになるよ！」

#### 成功時
- 「やったね！完璧だよ！」
- 「さすが！その調子！」
- 「すごい！もうマスターだね！」

#### 失敗時（優しくフォロー）
- 「惜しい！もう一回やってみよう」
- 「大丈夫、私も最初は間違えたよ」
- 「ヒント：Escを押してみて？」

#### 日本語入力警告
- 「あれ？日本語モードになってるよ！」
- 「英数に切り替えてね！」

#### 励まし（生産性の谷で）
- 「今は『生産性の谷』にいるけど、もう少しで登り切れるよ！」
- 「Vimは最初は遅く感じるけど、慣れると最高なの！」

---

## 4. カリキュラム構成（第0章〜第6章）

### 全体構成

| 章 | タイトル | テーマ | 目的 | 難易度 |
|----|---------|--------|------|--------|
| 第0章 | 閉ざされた扉からの脱出 | 生存と安全確保 | パニック防止・心理的安全性 | ★☆☆☆☆ |
| 第1章 | ダンジョンの歩き方 | 移動 | hjklへの段階的適応 | ★★☆☆☆ |
| 第2章 | 魔法の文法 | Vim Grammar | 「動詞+名詞」の理解 | ★★☆☆☆ |
| 第3章 | 箱の中身を変える | テキストオブジェクト | **アハ体験**の創出 | ★★★☆☆ |
| 第4章 | 繰り返しの秘儀 | 効率化 | ドットコマンドの快感 | ★★★☆☆ |
| 第5章 | 異世界の常識 | メンタルモデル | レジスタ・バッファの理解 | ★★★★☆ |
| 第6章 | 現実世界への帰還 | 環境との共存 | VSCode+Vim等の実用着地 | ★★★★☆ |

### 学習時間の目安

| 章 | 学ぶ | 練習 | 実践 | 合計 |
|----|------|------|------|------|
| 第0章 | 5分 | 5分 | 5分 | 約15分 |
| 第1章 | 5分 | 10分 | 10分 | 約25分 |
| 第2章 | 10分 | 15分 | 15分 | 約40分 |
| 第3章 | 10分 | 15分 | 15分 | 約40分 |
| 第4章 | 5分 | 10分 | 10分 | 約25分 |
| 第5章 | 10分 | 10分 | 10分 | 約30分 |
| 第6章 | 10分 | - | 15分 | 約25分 |
| **合計** | | | | **約3時間20分** |

---

## 5. 各章の詳細設計

### 第0章：閉ざされた扉からの脱出（生存と安全確保）

#### ストーリー
にゃぱんがVimの世界に閉じ込められた！「終了コマンド」を入力して救出しよう。

#### 学ぶ (Learn)
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  🐱 にゃぱん「ここから出るには :q! という呪文が必要！」 │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  🆘 緊急脱出法                                   │   │
│  │                                                 │   │
│  │  何が起きても → ESC 連打 → :q! → Enter         │   │
│  │                                                 │   │
│  │  これで必ず無傷で脱出できます！                 │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  📚 モードの正体                                        │
│  ┌─────────────────────────────────────────────────┐   │
│  │  なぜモードがあるの？                           │   │
│  │  → 「文字入力」と「命令」を分けるため           │   │
│  │  → 認知負荷を下げる設計なの                     │   │
│  │                                                 │   │
│  │  [ノーマル] ←ESC─ [インサート]                  │   │
│  │      ↓i,a,o                                     │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  ⚠️ 日本語入力の罠                                     │
│  ┌─────────────────────────────────────────────────┐   │
│  │  「ｋｊｌ」と打っても動かない！                  │   │
│  │  → 日本語入力がONになっているから              │   │
│  │  → 英数に切り替えてからコマンドを打とう        │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 練習 (Practice)
- **避難訓練**: わざとモードを迷子にして、ESCで復帰する
- **エラー体験**: 日本語入力のままコマンドを打ち、にゃぱんの警告を見る
- **終了フローチャート**: 状況別の終了方法を選択式で学ぶ

```
終了方法フローチャート
─────────────────────
保存したい？
├─ YES → :wq (保存して終了)
└─ NO
    └─ 変更を捨てていい？
        ├─ YES → :q! (強制終了)
        └─ NO → :w で保存してから :q
```

#### 実践 (Quest)
- Vimを起動し、何もせずに安全に閉じる（3回繰り返し）
- 成功するとにゃぱんが脱出し「ありがとう！」と笑顔に

---

### 第1章：ダンジョンの歩き方（移動）

#### ストーリー
マウスが壊れた世界。にゃぱんをゴールまで誘導しよう。

#### 学ぶ (Learn)
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  🐱 にゃぱん「矢印キーが錆びついて動かない床なの...    │
│              hjkl の魔法で私を動かして！」             │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  🎯 なぜ hjkl？                                  │   │
│  │                                                 │   │
│  │  矢印キーまで手を動かす → 往復0.5秒のロス      │   │
│  │  1日1000回移動すると → 約8分の損失！           │   │
│  │                                                 │   │
│  │  hjkl ならホームポジションのまま移動できる     │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │        k (上)                                   │   │
│  │          ↑                                      │   │
│  │  h (左) ← · → l (右)                           │   │
│  │          ↓                                      │   │
│  │        j (下)                                   │   │
│  │                                                 │   │
│  │  💡 覚え方: j の縦棒が下を向いてる！           │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  ✅ 最初は矢印キーでもOK！                             │
│     にゃぱん「無理しなくていいよ、徐々に慣れよう」    │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 練習 (Practice)
- **迷路ゲーム**: グリッド上のにゃぱんを操作してコインを集める
- 矢印キーも使えるが、にゃぱんが「矢印キーだと遅いなあ...」とぼやく
- hjklを使うと「速い！さすが！」と褒める

#### 実践 (Quest)
- 実際のコードファイルで「15行目のエラー箇所まで移動せよ」
- タイムリミット付きでゲーム性を追加

---

### 第2章：魔法の文法（Vim Grammar）

#### ストーリー
邪魔なブロック（テキスト）を消去魔法で取り除こう。

#### 学ぶ (Learn)
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  🐱 にゃぱん「Vim語の魔法は『動詞』＋『名詞』で       │
│              できているの！」                          │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  📝 Vim Grammar（Vim文法）                       │   │
│  │                                                 │   │
│  │  動詞（オペレータ）    名詞（モーション）       │   │
│  │  ┌──────────────┐    ┌──────────────┐          │   │
│  │  │ d = Delete   │ +  │ w = Word     │ = dw    │   │
│  │  │ c = Change   │    │ $ = 行末    │          │   │
│  │  │ y = Yank     │    │ 0 = 行頭    │          │   │
│  │  └──────────────┘    └──────────────┘          │   │
│  │                                                 │   │
│  │  例:                                            │   │
│  │  dw = 「単語を削除せよ」                        │   │
│  │  d$ = 「行末まで削除せよ」                      │   │
│  │  cw = 「単語を書き換えよ」                      │   │
│  │                                                 │   │
│  │  💡 このルールで無限に組み合わせ可能！         │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  🐱「ショートカットを100個覚えるより、                │
│      文法を1つ覚える方が楽でしょ？」                  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 練習 (Practice)
- **パズルゲーム**: 画面に出る「動詞」と「名詞」を組み合わせてタイピング
- **モンスター退治**: 不要な単語（モンスター）を正しいコマンドで倒す

#### 実践 (Quest)
- バグだらけのコードを `dw` や `cw` で修正するリファクタリング課題

---

### 第3章：箱の中身を変える（テキストオブジェクト）

#### ストーリー
宝箱（カッコ）の中身を一瞬で入れ替える上級魔法。**ここが最大のアハ体験ポイント！**

#### 学ぶ (Learn)
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  🐱 にゃぱん「これがVimの真の力...！                   │
│              カッコの中身を一瞬で書き換えられるの！」  │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  ✨ テキストオブジェクト                         │   │
│  │                                                 │   │
│  │  i = inner (中身だけ)                           │   │
│  │  a = around (周りも含めて)                      │   │
│  │                                                 │   │
│  │  例: "Hello, World!"                            │   │
│  │       └───┬───┘                                 │   │
│  │           ↓                                     │   │
│  │  ci" → 中身を書き換え → "|"（入力待ち）        │   │
│  │  da" → 引用符ごと削除 → （消える）             │   │
│  │                                                 │   │
│  │  ┌─────────────────────────────────────┐       │   │
│  │  │  対象      inner (i)    around (a) │       │   │
│  │  │  ─────────────────────────────────  │       │   │
│  │  │  単語 w    iw           aw          │       │   │
│  │  │  " "       i"           a"          │       │   │
│  │  │  ( )       i(           a(          │       │   │
│  │  │  { }       i{           a{          │       │   │
│  │  │  < >       i<           a<          │       │   │
│  │  │  タグ      it           at          │       │   │
│  │  └─────────────────────────────────────┘       │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  🐱「VSCodeだとカーソルを細かく動かす必要があるけど、 │
│      Vimならカッコの中にいるだけで一発だよ！」        │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 練習 (Practice)
- **リズムゲーム**: 流れてくる `("text")` を `ci"` で次々と書き換え
- 爽快なエフェクトで「気持ちいい！」を演出

#### 実践 (Quest)
- HTMLのクラス名を書き換える
- JSONの値を修正する
- Web開発でよくあるタスクを「ワンコマンド」で

---

### 第4章：繰り返しの秘儀（効率化）

#### ストーリー
同じ作業を何度もするのは面倒。分身魔法を使おう。

#### 学ぶ (Learn)
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  🐱 にゃぱん「さっきの魔法、. (ドット) だけで         │
│              もう一回使えるよ！」                      │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  ⚡ ドットコマンド (.)                           │   │
│  │                                                 │   │
│  │  「直前の変更を繰り返す」                       │   │
│  │  → Vim最強のコマンドの一つ                     │   │
│  │                                                 │   │
│  │  例: リストの先頭にハイフンを追加               │   │
│  │                                                 │   │
│  │  1. I-<Esc>  (先頭に - を挿入)                  │   │
│  │  2. j.       (次の行で繰り返し)                 │   │
│  │  3. j.       (また繰り返し)                     │   │
│  │  4. j.j.j.   (ズババババ！)                     │   │
│  │                                                 │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  🔄 アンドゥ (u)                                 │   │
│  │                                                 │   │
│  │  失敗しても u で戻せる！                        │   │
│  │  → 失敗を恐れず試行錯誤しよう                  │   │
│  │                                                 │   │
│  │  Ctrl+r でリドゥ（やり直しの取り消し）         │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 練習 (Practice)
- リストの先頭に記号をつける作業を `j.` で高速処理
- 「ズババババ！」という連続エフェクトで快感を演出

#### 実践 (Quest)
- 複数行のコード末尾にカンマを追加
- 「ドットコマンドで10秒以内に完了せよ」ミッション

---

### 第5章：異世界の常識（メンタルモデル）

#### ストーリー
VSCodeとは違うVim世界のルールを学ぼう。

#### 学ぶ (Learn)
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  🐱 にゃぱん「Vimには独自のルールがあるの。            │
│              これを知らないと混乱しちゃうよ」         │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  📋 削除 = カット（切り取り）                    │   │
│  │                                                 │   │
│  │  d で削除した内容は「無名レジスタ」に入る       │   │
│  │  → つまり削除 = クリップボードにコピー         │   │
│  │  → p で貼り付け可能                            │   │
│  │                                                 │   │
│  │  💡 「消したはずの文字が p で出てきた！」      │   │
│  │     の正体はこれ                                │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  📑 タブ ≠ ファイル                              │   │
│  │                                                 │   │
│  │  ┌─────────────────────────────────────────┐   │   │
│  │  │  タブ = レイアウト（ビューポート）      │   │   │
│  │  │  バッファ = ファイルの実体              │   │   │
│  │  │  ウィンドウ = バッファを表示する窓      │   │   │
│  │  └─────────────────────────────────────────┘   │   │
│  │                                                 │   │
│  │  VSCodeのタブとは違う概念！                     │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  🖥️ OSのクリップボードとの連携                   │   │
│  │                                                 │   │
│  │  Ctrl+V が効かない理由:                         │   │
│  │  → VimのレジスタとOSのクリップボードは別物     │   │
│  │                                                 │   │
│  │  連携方法:                                      │   │
│  │  "+y  → OSのクリップボードにコピー             │   │
│  │  "+p  → OSのクリップボードから貼り付け         │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 練習 (Practice)
- レジスタの中身を可視化したシミュレーション
- 削除→貼り付けの挙動を体験

#### 実践 (Quest)
- 別ファイルからコードをコピーし、現在のファイルに貼り付け
- 不要部分を削除して入れ替える一連のフロー

---

### 第6章：現実世界への帰還（環境との共存）

#### ストーリー
Vimの世界を冒険したあなたは、現実世界でもVimの力を使えるようになった。

#### 学ぶ (Learn)
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  🐱 にゃぱん「Vimの操作は、他のエディタでも使えるよ！ │
│              完全移行しなくても大丈夫」               │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  🎯 ゴールは「完全移行」だけじゃない！          │   │
│  │                                                 │   │
│  │  ✅ VSCode + Vim拡張 → 立派な正解！           │   │
│  │  ✅ JetBrains + IdeaVim → これも正解！        │   │
│  │  ✅ 純粋なVim/Neovim → もちろん正解！         │   │
│  │                                                 │   │
│  │  「良いとこ取り」で生産性を上げよう            │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │  ⚠️ 設定の沼に注意！                            │   │
│  │                                                 │   │
│  │  最初から完璧な .vimrc を目指すと               │   │
│  │  「設定破産」して挫折します                    │   │
│  │                                                 │   │
│  │  まずは:                                        │   │
│  │  1. このサイトで純粋な操作スキルを習得         │   │
│  │  2. VSCode + Vim拡張で実践                     │   │
│  │  3. 慣れてきたら設定を少しずつ追加             │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  🐱「私との冒険はここで終わりだけど、                 │
│      あなたのVimライフはこれからだよ！」             │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 実践 (Quest)
- 自分のエディタにVim拡張を導入
- 第3章のテキストオブジェクトが使えるか試す
- 「どこでもVimが使える」体験

---

## 6. 挫折防止システム機能

### 6.1 日本語入力検知アラート

```javascript
// IME状態の推測（keydownイベントのProcessキー検知）
const detectIME = (e) => {
  if (e.key === 'Process' || e.keyCode === 229) {
    showNyapanAlert('日本語入力になってるよ！英数に切り替えてね！');
  }
};
```

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   ⚠️ にゃぱんアラート                                  │
│   ┌─────────────────────────────────────────────────┐   │
│   │  🐱💦「あれ？日本語モードになってるよ！        │   │
│   │        英数に切り替えてね！」                  │   │
│   │                                                 │   │
│   │  [Mac] Cmd + Space                             │   │
│   │  [Win] 半角/全角 キー                          │   │
│   └─────────────────────────────────────────────────┘   │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 6.2 迷子救済ボタン

画面の隅に常設。クリックすると現在の状態を解説。

```
┌─────────────────────────────────────────────────────────┐
│                                             [🐱 助けて] │
│                                                         │
│  クリック時:                                            │
│  ┌─────────────────────────────────────────────────┐   │
│  │  🐱 にゃぱんヘルプ                              │   │
│  │                                                 │   │
│  │  📍 現在の状態: インサートモード               │   │
│  │                                                 │   │
│  │  「今は文字入力モードだよ。                    │   │
│  │   Esc を押せばノーマルモードに戻れるよ！」    │   │
│  │                                                 │   │
│  │  [Escを押す] [最初からやり直す]                │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 6.3 時間節約スコア表示

Vimの価値を数値で実感させる。

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  ⏱️ 今の操作                                            │
│  ┌─────────────────────────────────────────────────┐   │
│  │  マウス操作なら: 3.2秒                          │   │
│  │  あなたのVim:   0.5秒                          │   │
│  │                                                 │   │
│  │  💰 節約した時間: 2.7秒                         │   │
│  │  📊 累計節約時間: 12分30秒                      │   │
│  │                                                 │   │
│  │  🐱「この調子！どんどん速くなってるね！」      │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 6.4 生産性の谷マップ

現在地を示して不安を解消。

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  📈 あなたの学習マップ                                  │
│                                                         │
│  生産性                                                 │
│    ↑                              ★ Vimマスター        │
│    │                           ／                      │
│    │                         ／                        │
│    │  ───────           ／                            │
│    │          ＼      ／                               │
│    │            ＼  ／                                 │
│    │              ✗ ← 今ここ（生産性の谷）            │
│    │                                                   │
│    └─────────────────────────────────→ 学習時間        │
│                                                         │
│  🐱「今は谷にいるけど、あと2章で登り切れるよ！        │
│      諦めないで！」                                    │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 6.5 失敗シミュレーション

安全な環境でエラーを体験し、本番でのパニックを防ぐ。

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  🎭 失敗体験コーナー                                    │
│                                                         │
│  「ESCを押し忘れるとどうなる？」                       │
│                                                         │
│  [体験してみる]                                         │
│                                                         │
│  → インサートモードで :q と打つ                        │
│  → 「:q」という文字がそのまま入力される               │
│  → にゃぱん「あー！文字になっちゃった！              │
│              こういう時は u で戻して、                 │
│              Esc を押してからコマンドを打ってね」     │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 7. UI/UX設計

### カラーテーマ

黒い画面への恐怖を和らげるため、**パステル調をベース**にする。

| 要素 | ライトモード | ダークモード |
|------|-------------|-------------|
| メイン背景 | #FFF5F5 (ピンクベージュ) | #2D2D3A (ダークパープル) |
| サブ背景 | #FFFFFF | #1E1E2E |
| エディタ背景 | #FFFEF0 (クリーム) | #282A36 |
| テキスト | #333333 | #F8F8F2 |
| アクセント | #FF6B9D (ピンク) | #FF79C6 |
| 成功 | #4CAF50 | #50FA7B |
| 警告 | #FFC107 | #FFB86C |
| エラー | #E57373 | #FF5555 |
| キャラ吹き出し | #E3F2FD | #44475A |

### レスポンシブ対応

| デバイス | 対応状況 |
|---------|---------|
| PC (1024px以上) | フル機能 |
| タブレット (768px-1023px) | 対応（キーボード縮小） |
| スマホ (767px以下) | 閲覧モード（実践は制限）+ 警告表示 |

### 画面レイアウト

```
┌──────────────────────────────────────────────────────────┐
│  ヘッダー                                      [🐱助けて] │
│  [にゃぱんとVim] [章一覧] [コマンド] [復習] [進捗]      │
│  ────────────────────────────────────────────────────── │
│  学習マップ [===========|----] 第3章 / 全6章           │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  ┌──────────────┐  ┌────────────────────────────────┐   │
│  │              │  │                                │   │
│  │   にゃぱん   │  │     メインコンテンツ           │   │
│  │   [状態連動] │  │     (エディタ/問題)            │   │
│  │              │  │                                │   │
│  │   💬 吹き出し │  │                                │   │
│  │   ┌────────┐ │  │                                │   │
│  │   │セリフ  │ │  │                                │   │
│  │   └────────┘ │  │                                │   │
│  └──────────────┘  └────────────────────────────────┘   │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐│
│  │  ⌨️ キーボードビジュアライザー                       ││
│  │  [q][w][e][r][t][y][u][i][o][p]                     ││
│  │   [a][s][d][f][g][h][j][k][l]                       ││
│  │    [z][x][c][v][b][n][m]                            ││
│  │  入力履歴: d → w → j → . → j → .                   ││
│  └──────────────────────────────────────────────────────┘│
│                                                          │
├──────────────────────────────────────────────────────────┤
│  [📢シェア] [⏱️節約時間: 12:30] [⚙️設定]                │
└──────────────────────────────────────────────────────────┘
```

---

## 8. リアルタイムキーボード表示

### 機能一覧

| 機能 | 説明 |
|------|------|
| **学習キーハイライト** | 今の章で使うキーを色付け |
| **リアルタイム点灯** | 押したキーが0.2秒光る |
| **モード別カラー** | ノーマル=青、インサート=緑、コマンド=黄 |
| **入力履歴** | 直近10回の入力を矢印で表示 |
| **正解/不正解** | 正解=緑点灯、不正解=赤点灯 |
| **コンボ表示** | `dw`, `ci"` などの組み合わせを表示 |
| **ツールチップ** | ホバーでコマンド説明 |

### キーボードレイアウト

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  現在のモード: [ノーマル]                               │
│                                                         │
│  ┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┐│
│  │Esc│ 1 │ 2 │ 3 │ 4 │ 5 │ 6 │ 7 │ 8 │ 9 │ 0 │ - │ = ││
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤│
│  │Tab│ q │ w │ e │ r │ t │ y │ u │ i │ o │ p │ [ │ ] ││
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤│
│  │Ctl│ a │ s │ d │ f │ g │[h]│[j]│[k]│[l]│ ; │ ' │Ent││
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤│
│  │Sft│ z │ x │ c │ v │ b │ n │ m │ , │ . │ / │Shift  ││
│  └───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───────┘│
│                                                         │
│  [h][j][k][l] = 現在学習中のキー（ハイライト）         │
│                                                         │
│  入力履歴: d → w → [完了✓] → j → . → j → .            │
│  コンボ: dw (単語削除)                                  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 9. 覚えたコマンド一覧

### 画面レイアウト

```
┌─────────────────────────────────────────────────────────┐
│  📚 コマンドブック                                      │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                         │
│  [フィルター] 全て | 移動 | 編集 | テキストObj | 習得済 │
│                                                         │
│  ┌─────────┬──────────────────┬────────┬─────────┐     │
│  │ コマンド │ 説明              │ 習熟度  │ 最終練習 │     │
│  ├─────────┼──────────────────┼────────┼─────────┤     │
│  │ h       │ 左に移動          │ ★★★★★ │ 今日     │     │
│  │ ci"     │ "の中身を書換     │ ★★★☆☆ │ 昨日     │     │
│  │ dw      │ 単語削除          │ ★★☆☆☆ │ 3日前   │     │
│  │ .       │ 直前操作を繰返    │ ★☆☆☆☆ │ 1週間前  │     │
│  └─────────┴──────────────────┴────────┴─────────┘     │
│                                                         │
│  🐱「. は久しぶりだね、復習しよう？」                  │
│                                                         │
│  総習得: 24個 / 全50個                                  │
│  [復習が必要: 8個]                                      │
└─────────────────────────────────────────────────────────┘
```

### 習熟度システム

| レベル | 条件 |
|--------|------|
| ★☆☆☆☆ | 1回成功 |
| ★★☆☆☆ | 3回成功 |
| ★★★☆☆ | 5回成功 + 3日以内に使用 |
| ★★★★☆ | 10回成功 + 1週間以内に使用 |
| ★★★★★ | 20回成功 + 継続使用 |

---

## 10. 復習モード

### スペースド・リピティション

```
┌─────────────────────────────────────────────────────────┐
│  🔄 復習タイム                                          │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                         │
│  🐱「久しく使ってないコマンドを復習しよう！」          │
│                                                         │
│  問題 3/8                                               │
│  ┌─────────────────────────────────────────────────┐   │
│  │                                                 │   │
│  │  「引用符の中身を書き換えるコマンドは？」      │   │
│  │                                                 │   │
│  │  例: "Hello" → "|"                              │   │
│  │                                                 │   │
│  │  ▶ 入力: [      ]                              │   │
│  │                                                 │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  [💡ヒント] [⏭️スキップ]                                │
│                                                         │
│  ヒント: c + i + 記号...                               │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 復習モードの種類

| モード | 説明 |
|--------|------|
| クイック復習 | 5問サクッと |
| しっかり復習 | 全ての要復習コマンド |
| カテゴリ復習 | 特定カテゴリのみ |
| 弱点克服 | 間違えやすいコマンド集中 |

---

## 11. 進捗管理・実績システム

### 進捗ダッシュボード

```
┌─────────────────────────────────────────────────────────┐
│  📊 あなたの冒険記録                                    │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                         │
│  📈 学習進捗                                            │
│  [████████████░░░░░░░░] 60% (第4章まで完了)            │
│                                                         │
│  ⏱️ 累計学習時間: 2時間15分                             │
│  💰 節約した時間: 45分                                  │
│  🔥 連続学習: 5日                                       │
│                                                         │
│  🏅 獲得バッジ                                          │
│  ┌─────────────────────────────────────────────────┐   │
│  │ [🆘 生存者]  [🚶 移動の達人]  [📝 文法マスター] │   │
│  │ [✨ 魔法使い]  [🔥 5日連続]                     │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  🐱「すごい進歩！次は第5章に挑戦しよう！」            │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 実績バッジ一覧

| バッジ | 名前 | 条件 |
|--------|------|------|
| 🆘 | 生存者 | 第0章クリア |
| 🚶 | 移動の達人 | 第1章クリア |
| 📝 | 文法マスター | 第2章クリア |
| ✨ | 魔法使い | 第3章クリア（テキストオブジェクト） |
| ⚡ | 効率の鬼 | 第4章クリア |
| 🧠 | 異世界適応者 | 第5章クリア |
| 🏠 | 帰還者 | 第6章クリア（全章完了） |
| 🔥 | 連続学習○日 | 連続ログイン |
| 💯 | 完璧主義者 | 正答率100%でクリア |
| ⏱️ | 時間節約1時間 | 累計節約時間1時間達成 |

---

## 12. SNSシェア機能

### シェア画面

```
┌─────────────────────────────────────────────────────────┐
│  🎉 実績解除！                                          │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │                                                 │   │
│  │  ✨「魔法使い」を獲得！                         │   │
│  │                                                 │   │
│  │  🐱 にゃぱん「テキストオブジェクトを           │   │
│  │              マスターしたね！」                 │   │
│  │                                                 │   │
│  │  習得コマンド: ci", da(, dit など              │   │
│  │  正答率: 95%                                    │   │
│  │  節約時間: +15分                                │   │
│  │                                                 │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  📢 成果をシェアしよう！                                │
│                                                         │
│  [🐦 X(Twitter)]  [📋 コピー]  [📱 シェア]             │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### シェアテンプレート（X/Twitter）

```
🐱 にゃぱんと一緒にVim学習中！

✨「魔法使い」の称号を獲得！
テキストオブジェクトをマスターしたよ！

📊 習得コマンド: ci", da(, dit
⏱️ 累計節約時間: 45分
🔥 連続学習: 5日目

#にゃぱんとVim #Vim学習

🔗 {サイトURL}
```

---

## 13. 技術仕様

### 技術スタック

| 項目 | 技術 |
|------|------|
| フレームワーク | React 18.x |
| ビルドツール | Vite |
| 言語 | JavaScript (ES6+) |
| スタイリング | CSS Modules |
| アニメーション | CSS Animations / Framer Motion |
| 状態管理 | React Hooks + Context |
| ルーティング | React Router v6 |
| データ保存 | LocalStorage |
| Vimエミュレータ | カスタム実装 or Wasm版Vim |

### 主要カスタムフック

```javascript
// useVimMode - Vimモード管理
const useVimMode = () => {
  const [mode, setMode] = useState('normal'); // normal, insert, command, visual
  const [nyapanState, setNyapanState] = useState('waiting');
  // ...
};

// useKeyCapture - キー入力検知 + IME検知
const useKeyCapture = () => {
  const [pressedKey, setPressedKey] = useState(null);
  const [isIMEOn, setIsIMEOn] = useState(false);

  useEffect(() => {
    const handleKeyDown = (e) => {
      if (e.key === 'Process' || e.keyCode === 229) {
        setIsIMEOn(true);
        showNyapanAlert('ime');
      }
      // ...
    };
  }, []);
};

// useProgress - 進捗・習熟度管理
const useProgress = () => {
  // LocalStorageとの同期
  // スペースド・リピティション計算
};

// useTimeSaved - 節約時間計算
const useTimeSaved = () => {
  // マウス操作との比較時間を計算
};
```

### データ構造

```javascript
// ユーザー進捗データ (LocalStorage)
const userProgress = {
  currentChapter: 3,
  chapters: {
    0: { completed: true, score: 100, completedAt: '2025-12-18' },
    1: { completed: true, score: 95, completedAt: '2025-12-19' },
    // ...
  },
  commands: {
    'h': { successCount: 50, lastPracticed: '2025-12-20', masteryLevel: 5 },
    'ci"': { successCount: 8, lastPracticed: '2025-12-19', masteryLevel: 3 },
    // ...
  },
  achievements: ['survivor', 'movement_master', 'grammar_master'],
  streakDays: 5,
  totalPracticeTime: 8100, // 秒
  totalTimeSaved: 2700,    // 秒
};
```

---

## 14. ページ構成

### ルーティング

```
/vim-tutorial (または /nyapan-vim)
├── /                      → トップ（章一覧・進捗サマリー）
├── /chapter/:id           → 各章のページ
│   ├── /chapter/0         → 第0章: 生存
│   ├── /chapter/1         → 第1章: 移動
│   ├── /chapter/2         → 第2章: 文法
│   ├── /chapter/3         → 第3章: テキストオブジェクト
│   ├── /chapter/4         → 第4章: 効率化
│   ├── /chapter/5         → 第5章: メンタルモデル
│   └── /chapter/6         → 第6章: 環境
├── /practice              → フリー練習モード
├── /commands              → コマンドブック
├── /review                → 復習モード
├── /progress              → 進捗・実績
└── /share/:achievementId  → シェア用ページ（OGP対応）
```

---

## 15. 将来の拡張機能

### Phase 2

| 機能 | 説明 | 優先度 |
|------|------|--------|
| タイムアタックモード | 制限時間内にクリア | 中 |
| チートシート | 印刷可能なコマンド一覧 | 高 |
| キーボード音 | タイプ音のフィードバック | 低 |
| にゃぱん着せ替え | 季節衣装など | 低 |

### Phase 3

- ユーザーアカウント（クラウド同期）
- コミュニティ機能（Tips共有）
- 追加章（マクロ、正規表現など）
- 多言語対応

---

## 16. 付録：コマンド一覧

### 第0章（生存）

| コマンド | 説明 |
|---------|------|
| ESC | ノーマルモードに戻る |
| :q | 終了 |
| :q! | 強制終了（保存しない） |
| :w | 保存 |
| :wq | 保存して終了 |

### 第1章（移動）

| コマンド | 説明 |
|---------|------|
| h | 左に移動 |
| j | 下に移動 |
| k | 上に移動 |
| l | 右に移動 |
| w | 次の単語の先頭へ |
| b | 前の単語の先頭へ |
| e | 単語の末尾へ |
| 0 | 行頭へ |
| $ | 行末へ |
| gg | ファイル先頭へ |
| G | ファイル末尾へ |

### 第2章（Vim Grammar）

| 動詞 | 説明 |
|------|------|
| d | 削除 (Delete) |
| c | 変更 (Change) |
| y | コピー (Yank) |

| 名詞 | 説明 |
|------|------|
| w | 単語 (Word) |
| $ | 行末まで |
| 0 | 行頭まで |
| G | ファイル末尾まで |

| 組み合わせ例 | 説明 |
|-------------|------|
| dw | 単語を削除 |
| d$ | 行末まで削除 |
| cw | 単語を変更 |
| yy | 行をコピー |

### 第3章（テキストオブジェクト）

| コマンド | 説明 |
|---------|------|
| iw | inner word（単語の中身） |
| aw | around word（単語と周囲の空白） |
| i" | inner "（引用符の中身） |
| a" | around "（引用符含む） |
| i( | inner (（括弧の中身） |
| a( | around (（括弧含む） |
| it | inner tag（タグの中身） |
| at | around tag（タグ含む） |

| 組み合わせ例 | 説明 |
|-------------|------|
| ci" | 引用符の中身を変更 |
| da( | 括弧ごと削除 |
| yit | タグの中身をコピー |

### 第4章（効率化）

| コマンド | 説明 |
|---------|------|
| . | 直前の変更を繰り返す |
| u | アンドゥ |
| Ctrl+r | リドゥ |

### 第5章（メンタルモデル）

| コマンド | 説明 |
|---------|------|
| p | 下/後ろに貼り付け |
| P | 上/前に貼り付け |
| "+y | OSクリップボードにコピー |
| "+p | OSクリップボードから貼り付け |
| :e {file} | ファイルを開く |
| :bn | 次のバッファ |
| :bp | 前のバッファ |

---

**仕様書 終わり**

---

## 変更履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|---------|
| 1.0 | 2025-12-20 | 初版作成 |
| 2.0 | 2025-12-20 | 挫折防止特化版にリニューアル。リサーチ結果を統合し、「にゃぱん」キャラクター、モード連動、日本語入力検知、生産性の谷マップなどを追加 |
